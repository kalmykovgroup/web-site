# ‚úÖ –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ Production —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é

## –î–æ–º–µ–Ω –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã

- **–î–æ–º–µ–Ω**: volnaya-28.ru
- **Email**: admin@kalmykov-group.ru

## –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

```bash
# 1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ .env –Ω–∞—Å—Ç—Ä–æ–µ–Ω
cat .env
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ DOMAIN, EMAIL, DB_USER –∏ DB_PASSWORD –∑–∞–¥–∞–Ω—ã

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ
docker compose up -d

# 3. –ì–æ—Ç–æ–≤–æ! –°–∞–π—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ https://volnaya-28.ru
# SSL –Ω–∞—Å—Ç—Ä–æ–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

## –ß—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ

### ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env)

```env
DOMAIN=volnaya-28.ru
EMAIL=admin@kalmykov-group.ru
```

–§–∞–π–ª `.env` —É–∂–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏!

### ‚úÖ –£–º–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SSL

- –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏**
- `docker-compose build` **–ù–ï** –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 12 —á–∞—Å–æ–≤
- –ó–∞—â–∏—Ç–∞ –æ—Ç rate limits Let's Encrypt

### ‚úÖ Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

- –ù–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –¥–æ–º–µ–Ω–∞ volnaya-28.ru
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç HTTP ‚Üí HTTPS
- –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ ASP.NET Core API
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤

### ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- Docker secrets –¥–ª—è –ë–î –ø–∞—Ä–æ–ª–µ–π
- SSL/TLS 1.2 –∏ 1.3
- OCSP stapling
- Security headers
- –ù–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

### DNS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```bash
nslookup volnaya-28.ru
nslookup www.volnaya-28.ru
```

–û–±–∞ –¥–æ–º–µ–Ω–∞ –¥–æ–ª–∂–Ω—ã —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ IP –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.

### –û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –æ—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç—ã
sudo ufw allow 80/tcp   # HTTP
sudo ufw allow 443/tcp  # HTTPS
sudo ufw status
```

### –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –ü–û

```bash
docker --version        # >= 20.10
docker-compose --version # >= 1.29
git --version
```

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö SSL –∑–∞–ø—Ä–æ—Å–æ–≤

### 1. –ü—Ä–∏ docker-compose build
- ‚úÖ –°–±–æ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ –æ–±—Ä–∞–∑–∞ API
- ‚úÖ Nginx –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≥–æ—Ç–æ–≤—ã–π alpine –æ–±—Ä–∞–∑
- ‚ùå SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ù–ï –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è

### 2. –ü—Ä–∏ docker compose up -d
- ‚úÖ Docker Compose —á–∏—Ç–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ .env
- ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (PostgreSQL, Web API, Nginx, Certbot)
- ‚úÖ Nginx –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
- ‚úÖ –ï—Å–ª–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≤–∞–ª–∏–¥–µ–Ω (> 30 –¥–Ω–µ–π) - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–≥–æ
- ‚úÖ –ï—Å–ª–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –Ω–µ—Ç –∏–ª–∏ –Ω–µ–≤–∞–ª–∏–¥–µ–Ω - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç Let's Encrypt
- ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç HTTPS –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (certbot)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∫–∞–∂–¥—ã–µ 12 —á–∞—Å–æ–≤
- ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å—Ä–æ–∫ < 30 –¥–Ω–µ–π
- ‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π `certbot renew` –±–µ–∑ force

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
WebSite/
‚îú‚îÄ‚îÄ .env                        ‚úÖ volnaya-28.ru, admin@kalmykov-group.ru, DB credentials
‚îú‚îÄ‚îÄ docker-compose.yml          ‚úÖ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç .env, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π SSL
‚îú‚îÄ‚îÄ nginx/
‚îÇ   ‚îú‚îÄ‚îÄ conf.d/default.conf    ‚úÖ –Ω–∞—á–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ docker-entrypoint.sh   ‚úÖ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ SSL –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
‚îÇ   ‚îî‚îÄ‚îÄ generate-config.sh     ‚úÖ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ certbot/                    (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
    ‚îú‚îÄ‚îÄ conf/                   ‚úÖ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
    ‚îî‚îÄ‚îÄ www/                    ‚úÖ ACME challenge
```

## –°–ø–æ—Å–æ–± –∑–∞–ø—É—Å–∫–∞

–ü—Ä–æ–µ–∫—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π:

```bash
docker compose up -d
```

–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ‚úÖ Docker Compose —á–∏—Ç–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ .env
- ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç PostgreSQL —Å credentials –∏–∑ .env
- ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç ASP.NET Core Web API
- ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç Nginx —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ Nginx –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
- ‚úÖ –ï—Å–ª–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –Ω–µ—Ç –∏–ª–∏ –æ–Ω –Ω–µ–≤–∞–ª–∏–¥–µ–Ω - –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç Let's Encrypt
- ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç Certbot –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

–ì–æ—Ç–æ–≤–æ! –°–∞–π—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ https://volnaya-28.ru

## –ü–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

```bash
# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose ps

# –õ–æ–≥–∏
docker-compose logs -f

# SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
docker-compose exec nginx openssl x509 -enddate -noout \
  -in /etc/letsencrypt/live/volnaya-28.ru/fullchain.pem

# HTTP ‚Üí HTTPS —Ä–µ–¥–∏—Ä–µ–∫—Ç
curl -I http://volnaya-28.ru

# HTTPS —Ä–∞–±–æ—Ç–∞–µ—Ç
curl -I https://volnaya-28.ru
```

### –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å–∞–º

- **Website**: https://volnaya-28.ru
- **API**: https://volnaya-28.ru/api
- **PostgreSQL**: localhost:5444 (—Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏)

### SSL –æ—Ü–µ–Ω–∫–∞

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ SSL –Ω–∞:
https://www.ssllabs.com/ssltest/analyze.html?d=volnaya-28.ru

–û–∂–∏–¥–∞–µ—Ç—Å—è –æ—Ü–µ–Ω–∫–∞: **A –∏–ª–∏ A+**

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f webapi
docker-compose logs -f nginx
docker-compose logs -f postgres

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker-compose restart

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞
git pull
docker compose up -d --build

# SSL –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ Certbot
```

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [DEPLOY.md](DEPLOY.md) - –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é
- [SSL-SETUP.md](SSL-SETUP.md) - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ SSL
- [README.md](README.md) - –æ—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [QUICK-START.md](QUICK-START.md) - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs -f`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å: `docker-compose ps`
3. –°–º–æ—Ç—Ä–∏—Ç–µ [DEPLOY.md](DEPLOY.md) —Ä–∞–∑–¥–µ–ª "–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º"
4. Email: admin@kalmykov-group.ru

---

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ production —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é!** üöÄ
